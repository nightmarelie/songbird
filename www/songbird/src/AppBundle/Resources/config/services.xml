<?xml version="1.0" ?>
<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

	<services>
	    <service id="songbird.admin.user" class="AppBundle\Admin\UserAdmin">
  			<tag name="sonata.admin" manager_type="orm" group="admin" label="User"/>
  			<argument>null</argument>
  			<argument>AppBundle\Entity\User</argument>
  			<argument>AppBundle:UserAdmin</argument>
  			<call method="setUserManager">
  			    <argument type="service" id="fos_user.user_manager" />
  			</call>
      </service>

	    <service id="songbird.admin.user.show.filter" class="AppBundle\Event\UserCustomAction">
     		<tag name="kernel.event_listener" event="sonata.admin.event.configure.show" method="sonataAdminCheckUserRights" />
     		<argument type="service" id="service_container" />
   		</service>
   		
   		<service id="songbird.admin.user.form.filter" class="AppBundle\Event\UserCustomAction">
    		<tag name="kernel.event_listener" event="sonata.admin.event.configure.form" method="sonataAdminCheckUserRights" />
    		<argument type="service" id="service_container" />
   		</service>
   		
   		<service id="songbird.password.reset.success" class="AppBundle\Event\UserCustomAction">
     		<tag name="kernel.event_listener" event="fos_user.resetting.reset.success" method="redirectUserAfterPasswordReset" />
      	<argument type="service" id="service_container" />
      </service>
  
      <service id="sonata.block.service.dashboard.welcome" class="AppBundle\Block\DashboardWelcomeBlockService">
        <tag name="sonata.block" />
        <argument>Dashboard Welcome</argument>
        <argument type="service" id="templating" />
      </service>
      
      <service id="app.admin.page" class="AppBundle\Admin\PageAdmin">
        <tag name="sonata.admin" manager_type="orm" group="admin" label="Page"/>
        <argument>null</argument>
        <argument>AppBundle\Entity\Page</argument>
        <argument>AppBundle:PageAdmin</argument>
      </service>
      
      <service id="app.admin.pagemeta" class="AppBundle\Admin\PageMetaAdmin">
            <tag name="sonata.admin" manager_type="orm" group="admin" label="Page"/>
            <argument>null</argument>
            <argument>AppBundle\Entity\PageMeta</argument>
            <argument>AppBundle:PageMetaAdmin</argument>
      </service> 
      
      <service id="app.locale.listener" class="AppBundle\Event\LocaleListener">
        <tag name="kernel.event_listener" event="kernel.request" method="onKernelRequest" priority="17"/>
        <argument>%kernel.default_locale%</argument>
      </service>
      
      <service id="app.log_user_activity" class="AppBundle\Event\UserCustomAction">
        <tag name="kernel.event_listener" event="kernel.request" method="userLog" />
        <argument type="service" id="service_container" />
    </service>

      <service id="app.admin.user.log" class="AppBundle\Admin\UserLogAdmin">
        <tag name="sonata.admin" manager_type="orm" group="admin" label="User"/>
        <argument>null</argument>
        <argument>AppBundle\Entity\UserLog</argument>
        <argument>AppBundle:UserLogAdmin</argument>
      </service>
	</services>
</container>
